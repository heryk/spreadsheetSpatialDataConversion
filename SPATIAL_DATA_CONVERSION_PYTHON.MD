# How to Convert Spreadsheet Spatial Data to Geographic Coordinates (Decimal Degrees) with Python

This guide explains how to convert and standardize spatial data in an Excel spreadsheet to decimal degrees (DD).
This code was initially generated by ChatGPT and then improved by Heryk. It is designed to convert spatial data in a CSV file to decimal degrees, handling UTM and DMS coordinates, and outputting the results in a new CSV file. The code can also be adapted to handle other projections.

>[!NOTE]
>Ensure you have Python with `pandas` and `pyproj` libraries installed on your computer.

## 1. Install Python and proper libraries 

### Install python: 

At the command line, verify Python is installed: 
```
python --version
```

If not installed, you can download/install it from here: https://www.python.org/downloads/


### Install pip

At the command line, verify pip is installed:
```
pip --version
```

If not installed, you can install pip by running:
```
python -m ensurepip --upgrade
```

### Install pandas and pyproj

```
pip install pandas pyproj 
```

After installation, confirm that both packages are installed by running:
```
python -m pip show pandas
python -m pip show pyproj
```

## 2. Configure Spreadsheet

### Base Configuration

- **IMPORTANT:** Use periods (.) and not commas (,) for decimal values for all numeric coordinate data in your spreadsheet.

- Python will create two new columns named `lat_decimal` and `lon_decimal` to store all calculated DD values.

- **IMPORTANT:** The three projection conversion steps below only run when the expected column names are present. These steps are executed in order: Decimal Degrees → UTM → DMS. Once `lat_decimal`/`lon_decimal` are set by an earlier step, later steps will not overwrite those values.

### i — Decimal Degrees (DD)

- If you already have spatial coordinates in DD, use columns `decimlat` and `decimlong`. These are copied directly into `lat_decimal` and `lon_decimal`. Keeping the originals lets you compare with the computed results.


### ii — UTM Coordinates

- If you have no UTM coordinates to convert, you may ignore this step. If Python does not find the required UTM columns (`utmeast`, `utmnorth`, and `utmsrid`), this conversion step will be skipped. These columns must contain the spatial data you wish to convert.

- Identify the appropriate EPSG code for your UTM zone (e.g., WGS 84 / UTM zone 11N = EPSG:32611). Refer to EPSG.io DB for codes (Example: https://epsg.io/32611). Create a column named "utmsrid" and populate it with the corresponding SRID for each row. Example EPSG codes:

  - WGS 84 / UTM zone 11N: EPSG:32611 → `32611`

  - WGS 84 / UTM zone 12N: EPSG:32612 → `32612`

![alt text](images/image-utm.png)


### iii — Degree/Minute/Second (DMS)

- If you have no DMS values to convert, you may ignore this step. If Python does not find the required DMS columns (`deglat`, `minlat`, `seclat`, `deglong`, `minlong`, `seclong`), this conversion step will be skipped.

- Ensure the spreadsheet contains these six columns. These columns must contain your coordinate data in DMS that you wish to convert to DD.

![alt text](images/image-dms.png)


### Final Spreadsheet Formatting/Validation

- See `demoInputSpatialConversionData.csv` for an example of a correctly configured CSV.

- All other data columns found in this spreadsheet will simply be ignored in data conversion and copied as is into the final spreadsheet output.

### Save Spreadsheet to CSV Format

- Save the Excel spreadsheet as a CSV file (*.csv). This format is required for import. **IMPORTANT:** Use `;` (semicolon) as the column delimiter.

- Name the CSV file `input_spatial_data.csv` and place it in the same folder as the `spatial_converter.py` file.


## 3. Convert Spreadsheet with Python

- Open the Windows command line (CMD) to the folder containing the `spatial_converter.py` file.

- Run the Python script. By default, it looks for `input_spatial_data.csv` in the same folder and writes `output_converted_spatial_data.csv`.

```powershell
# Defaults (reads input_spatial_data.csv, writes output_converted_spatial_data.csv)
python spatial_converter.py

# With flags
python spatial_converter.py -i .\input_spatial_data.csv -o .\output_converted_spatial_data.csv

# With positional arguments (input then output)
python spatial_converter.py .\input_spatial_data.csv .\output_converted_spatial_data.csv
```

If run successfully, the Python code will create a file named `output_converted_spatial_data.csv` containing your converted spatial data. Your new DD coordinates will be in the columns `lat_decimal` and `lon_decimal`.


## 4. Validate DD Coordinates

You can open your exported CSV file in QGIS to visually validate the new spatial coordinates on a map. The `lat_decimal`/`lon_decimal` columns contain your new spatial coordinates in the CSV file.

**Useful info for QGIS:**
- How to connect PostGIS to QGIS: A Step-by-Step Guide (Tutorial) - See step 4 - https://medium.com/@faithabiala/how-to-connect-postgis-to-qgis-a-step-by-step-guide-tutorial-72375c7cc71d
- Add an OpenStreetMap layer to QGIS - https://www.youtube.com/watch?v=XHQawq_tP98
- Use projection epsg:3857 for a better display of OpenStreetMap in QGIS.

![alt text](images/image-qgis.png)

---

## Troubleshooting

- "Unable to import 'pandas'" or "Import 'pyproj' could not be resolved":
  - Ensure packages are installed: `pip install pandas pyproj`.
  - If using VS Code, select the correct interpreter (your virtual environment) via Command Palette → Python: Select Interpreter.
  - Reload VS Code window if warnings persist.

- No rows converted for UTM/DMS:
  - Confirm column names exactly match expected names.
  - Check for `;` as the delimiter and correct numeric formats (use periods for decimals).

- Unexpected coordinate values:
  - Verify the correct EPSG code is in `utmsrid` for each row (e.g., 32611 for WGS 84 / UTM zone 11N).


